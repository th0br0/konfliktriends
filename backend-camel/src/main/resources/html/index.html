<!DOCTYPE html>
<html>
<head>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no'/>
    <script src='//api.tiles.mapbox.com/mapbox.js/v2.1.2/mapbox.js'></script>
    <link href='//api.tiles.mapbox.com/mapbox.js/v2.1.2/mapbox.css' rel='stylesheet'/>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
    <title>Hello World!</title>
</head>
<body>
<div id='map'></div>
<script type='text/javascript'>
    var ws = new WebSocket("ws://localhost:9292/websocket");
    ws.onopen = function (evt) {
        console.log(evt);
    };

	ws.onmessage = function(evt) {
        console.log(evt.data);
		var data = JSON.parse(evt.data);
	};


    var map = L.mapbox.map('map', 'fcc.map-toolde8w', {
        accessToken: "pk.eyJ1IjoidGgwYnIwIiwiYSI6IjYwdHpBYWsifQ.qNw3Epcuw_AkvqNNXNCgng"
    })
            .setView([31.5171, 34.6715], 10);
    queue()
            .defer(d3.json, "test.geojson")
            .await(ready);
    function ready(error, data) {
        L.geoJson(data).addTo(map);
    }
</script>
</body>
</html>
